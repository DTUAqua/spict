<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="T.K. Mildenberger, A. Kokkalis, C.W. Berg" />


<title>Guidelines for the use of the stochastic production model in continuous time (SPiCT)</title>






<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Guidelines for the use of the stochastic production model in continuous time (SPiCT)</h1>
<h4 class="author">T.K. Mildenberger, A. Kokkalis, C.W. Berg</h4>
<h4 class="date">27 September, 2019</h4>



<p>This is a living document, be sure to check for the latest update (<a href="https://github.com/mawp/spict/issues/new">link</a>). The SPiCT package is actively developed, check for the most recent package version and report problems at (<a href="https://github.com/mawp/spict/issues/new">link</a>).</p>
<table>
<thead>
<tr class="header">
<th align="left">Document version</th>
<th align="center">SPiCT version</th>
<th align="right">Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">v 1.0</td>
<td align="center">v 1.2.8</td>
<td align="right">Initial version (2019-09-23)</td>
</tr>
</tbody>
</table>
<p>This document provides specific guidelines for the use of the stochastic production model in continuous time (SPiCT; Pedersen and Berg, 2017). The following is divided into three parts, containing: (i) the main assumptions and data requirements of SPiCT, (ii) a checklist for the acceptance of a SPiCT assessment, and (iii) other helpful tips.</p>
<p>Most of the following guidelines and tips are accompanied by sample code that assumes</p>
<ul>
<li>input data is contained in a list called ‘<code>inp</code>’,</li>
<li>the results are contained in a list called ‘<code>fit</code>’ after fitting SPiCT to the input data with <code>fit &lt;- fit.spict(inp)</code>, and</li>
<li>calculating the one-step-ahead residuals with <code>fit &lt;- calc.osa.resid(fit)</code>.</li>
</ul>
<div id="main-assumptions-and-input-data-for-spict" class="section level2">
<h2>Main assumptions and input data for SPiCT</h2>
<ul>
<li><p>Catch data should be representative of both landings and bycatch. It is also possible to use a time series of landings, but then the interpretation of the results is changed. If available, seasonal catches should be used as input. Catches are assumed to be taken over a period of time (e.g. years or quarters). The time vector in SPiCT should reflect the beginning of each catch interval (e.g. 2002.25 and 2002.75 for the second and fourth quarter catches, respectively). Additionally, the vector inp$dtc should reflect the length of each time interval (e.g. 1 for annual and 0.25 for quarterly catches, respectively).</p></li>
<li><p>Stock size indices should be in terms of biomass (not numbers) and representative of the exploitable stock biomass (ESB). In many cases, the gear selectivity of the commercial and scientific fleets do not coincide and thus the stock size indices have to be corrected to exclude smaller individuals that are not recruited to the commercial fleet.</p></li>
<li><p>Biomass indices are assumed to be snapshots on given time points. Therefore, the timing of survey indices has to be given as decimal years reflecting the timing of the survey in the vector inp$timeI (e.g. 1995.5 for the middle of the year). Commercial CPUE indices should be associated with the midpoint of the interval of the corresponding catches, i.e. middle of the year if they are based on yearly aggregated catches and effort.</p></li>
<li><p>If input data spans long periods and there is ecological evidence for potential changes in productivity, it is possible to fit productivity regime shifts or long-term gradual changes in productivity.</p></li>
<li><p>The Euler discretisation has to be finer than the data, i.e. for yearly data the Euler time step (inp$dteuler) has to be smaller than 1. A value of 1 changes the model to a discrete time production model with different model assumptions. The default value is 1/16 year, which is sufficient in most cases. The function <code>check.euler(fit)</code> allows to check if the discretisation is fine enough.</p></li>
</ul>
</div>
<div id="checklist-for-the-acceptance-of-a-spict-assessment" class="section level2">
<h2>Checklist for the acceptance of a SPiCT assessment</h2>
<p>ICES category 3 stocks can be managed using the official advice rule based on SPiCT (3.1.1 and 3.1.2 in ICES, 2018), which requires an accepted SPiCT assessment.</p>
<ol style="list-style-type: decimal">
<li><p>The assessment <strong>converged</strong> (<code>fit$opt$convergence</code> equals 0).</p></li>
<li><p>All <strong>variance parameters</strong> of the model parameters are <strong>finite</strong> (<code>all(is.finite(fit$sd)</code>) should be <code>TRUE</code>).</p></li>
<li><p><strong>No violation of model assumptions</strong> based on one-step-ahead residuals (bias, auto-correlation, normality). This means, that p-values are insignificant (<span class="math inline">\(\leq 0.05\)</span>), indicated by green titles in the graphs of <code>spictplot.diagnostics(fit)</code>. Slight violations of these assumptions do not necessarily invalidate model results.</p></li>
<li><p><strong>Consistent patterns in the retrospective analysis</strong> (<code>fit &lt;- fit.retro(fit)</code>). This means that there is no tendency of consistent under- or overestimation of the relative fishing mortality (<span class="math inline">\(\frac{F}{F_{MSY}}\)</span>) and relative biomass (<span class="math inline">\(\frac{B}{B_{MSY}}\)</span>) in successive assessment. The retrospective trajectories of those two quantities should be inside the confidence intervals of the base run.</p></li>
<li><p><strong>Realistic production curve</strong>. The shape of the production curve should not be too skewed (<span class="math inline">\(\frac{B_{MSY}}{K}\)</span> should be between 0.1 and 0.9). Low values of <span class="math inline">\(\frac{B_{MSY}}{K}\)</span> allow for an infinite population growth rate (<code>calc.bmsyk(fit)</code>).</p></li>
<li><p><strong>High assessment uncertainty</strong> can indicate a lack of contrast in the input data or violation of the ecological model assumptions. The main variance parameters (<code>logsdb</code>, <code>logsdc</code>, <code>logsdi</code>, <code>logsdf</code>) should not be unrealistically high. Confidence intervals for <span class="math inline">\(\frac{B}{B_{MSY}}\)</span> and <span class="math inline">\(\frac{F}{F_{MSY}}\)</span> should not span more than 1 order of magnitude (<code>calc.om(fit)</code>).</p></li>
<li><p><strong>Initial values do not influence the parameter estimates</strong> (<code>fit &lt;- check.ini(fit)</code>). The estimates should be the same for all initial values (<code>fit$ckeck.ini$resmat</code>). Runs which did not converge should not be considered in this regard.</p></li>
</ol>
</div>
<div id="optional-model-and-assessment-tuning-in-case-of-assessment-rejection" class="section level2">
<h2>Optional model and assessment tuning in case of assessment rejection</h2>
<p><strong>Disclaimer</strong>: An uncertain assessment is okay; the model should not be tweaked and parameters should not be fixed unless there is sufficient information and evidence to make such assumptions. Rather than avoiding uncertainty, it should be accounted for by means of stochastic harvest control rules.</p>
<ul>
<li><p>Increase <strong>iterations of optimisation</strong> Special error code (8) exceeded max.iter.. <code>inp$optimiser.control = list(iter.max = 1e4, eval.max = 1e4)</code></p></li>
<li><p>If the catch time series is longer than the survey(s), <strong>shortening the catch time series</strong> to cover only the period where there is an available biomass index may help model convergence. <code>inp = shorten.inp(inp, 2005, 2018)</code></p></li>
<li><p><strong>Adjust</strong> the parameter determining the <strong>shape of the production curve</strong> ‘<code>logn</code>’ or impose a prior (be aware that this modification might cause smaller confidence bands).</p></li>
<li><p>A prior for n based on a meta analysis, e.g. for all species pooled based on Thorson et al. (2011): <code>inp$priors$logn &lt;- c(log(log(1.478), 0.6, 1)</code></p>
<ul>
<li><p>Tighter Schaefer prior for n (or any other prior e.g. from meta studies): <code>inp$priors$logn &lt;- c(log(2), 0.5, 1)</code></p></li>
<li><p>Fixing n to resemble the Schaefer production model (or the meta study, alternatively): <code>inp$ini$logn &lt;- log(2); inp$phases$logn &lt;-   -1</code></p></li>
</ul></li>
<li><p>Use a <strong>prior for the initial depletion level</strong> based on available information, FOR EXAMPLE:</p>
<ul>
<li><p>If evidence or expert knowledge allows to infer that there was low or no exploitation before the beginning of the available data: initial depletion level could be assumed to be close to the carrying capacity (<strong>e.g.</strong> <code>inp$priors$logbkfrac &lt;-   c(log(0.8),0.5,1)</code>)</p></li>
<li><p>If evidence or expert knowledge allows to infer that there was low or no exploitation before the beginning of the available data: initial depletion level could be assumed to be a certain fraction of the carrying capacity (<strong>e.g.</strong> <code>inp$priors$logbkfrac &lt;-   c(log(0.2),0.5,1)</code>)</p></li>
</ul></li>
<li><p>If information on the level of uncertainty in the biomass index and/or the uncertainty of the catch is available prior distribution could be used for the observation error term of the indices (‘<code>logsdi</code>’) and catches (‘logsdc’), respectively. This requires to remove the priors for the ratios of process to observation errors (‘<code>logalpha</code>’) and (‘<code>logbeta</code>’), respectively.</p></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
